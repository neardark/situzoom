/*! situzoom - v0.1.0 - 2014-10-18
* https://github.com/neardark/situzoom
* Copyright (c) 2014 John McCormick; Licensed MIT */
!function(a,b,c,d){"use strict";a.fn.situZoom=function(c){function e(b){b.preventDefault(),"function"==typeof s.onZoomStarted&&s.onZoomStarted.call(this),t=a(b.currentTarget),u=a("<img />").attr({src:t.data("large"),"class":s.zoomedClass,title:t.attr("title")}),u.one("load",f).each(o)}function f(b){var c=a(b.currentTarget),e={};u.width=c[0].width,u.height=c[0].height,v=i(),t=a.extend({},t,j()),w=k(),e=l(),u.parent()!==d&&u.wrap("<figure></figure>"),u.parent("figure").css({margin:0,padding:0,left:t.xPos-e.x,top:t.yPos+v.scrollTop-e.y,position:"absolute","z-index":10}),m(),n(),"function"==typeof s.onZoomLoaded&&s.onZoomLoaded.call(b.currentTarget),c.parent("figure").css({cursor:"pointer",position:"absolute","z-index":s.zIndex,"-ms-transform":"scale("+p+") ","-webkit-transform":"scale("+p+") ",transform:"scale("+p+") ","backface-visibility":"hidden"}),c.css("display","block"),t.addClass("zoomed"),c.parent("figure").bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",g),c.parent("figure").click(h),"function"==typeof s.onZoomFinished&&s.onZoomFinished.call(b.currentTarget)}function g(b){var c=a(b.currentTarget);c.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),"function"==typeof s.onZoomFinished&&s.onZoomZoomed.call(this),u.attr("title")&&s.showTitles&&(console.log(u),console.log(p),u.parent("figure").append('<figcaption class="'+s.captionClass+'">'+u.attr("title")+"</figcaption>"),u.parent("figure").find("figcaption").css({position:"absolute",bottom:0,width:u.width*p,"-ms-transform":"scale("+1/p+")","-webkit-transform":"scale("+1/p+")",transform:"scale("+1/p+")","-ms-transform-origin":"left bottom","-webkit-transform-origin":"left bottom","transform-origin":"left bottom"}))}function h(b){var c=a(b.currentTarget);c.find("figcaption").remove(),c.css({"-ms-transform":"scale("+q+")","-webkit-transform":"scale("+q+")",transform:"scale("+q+")"}),"function"==typeof s.onZoomCloseStarted&&s.onZoomCloseStarted.call(this),c.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){a(this).remove(),a(".zoomed").removeClass("zoomed"),"function"==typeof s.onZoomRemoved&&s.onZoomRemoved.call(this)})}function i(){return{scrollTop:a(b).scrollTop(),width:a(b).width(),height:a(b).height()}}function j(){return{xPos:t.offset().left,yPos:t.offset().top-v.scrollTop}}function k(){return{x:t.xPos+t.width()/2<v.width/2?"left":"right",y:t.yPos+t.height()/2<v.height/2?"top":"bottom"}}function l(){return{x:"right"===w.x?u.width-t.width():0,y:"bottom"===w.y?u.height-t.height():0}}function m(){q=t.width()/u.width,u.parent("figure").css({transition:"all "+s.speed,"-ms-transform":"scale("+q+")","-webkit-transform":"scale("+q+")",transform:"scale("+q+")","-ms-transform-origin":w.x+" "+w.y,"-webkit-transform-origin":w.x+" "+w.y,"transform-origin":w.x+" "+w.y}),u.parent("figure").addClass("enlargement-zoomed"),u.parent("figure").attr("data-y-direction",w.y),u.parent("figure").attr("data-x-direction",w.x),a("body").prepend(u.parent("figure")),u.focus()}function n(){v.maxHeight="bottom"===w.y?t.yPos+t.height()-s.viewportPadding:v.height-t.yPos-s.viewportPadding,v.maxWidth="left"===w.x?v.width-t.xPos-s.viewportPadding:t.xPos+t.width()-s.viewportPadding,p=Math.min(v.maxHeight/u.height,v.maxWidth/u.width)}function o(b){b.complete&&a(b).load()}var p,q,r={captionClass:"caption",maxSize:1,onZoomReady:function(){},onZoomFinished:function(){},onZoomLoaded:function(){},onZoomRemoved:function(){},onZoomStarted:function(){},onZoomZoomed:function(){},onZoomCloseStarted:function(){},showTitles:!0,speed:"0.25s",viewportPadding:0,zIndex:99999999,zoomedClass:"zoomified"},s=a.extend({},r,c),t={},u={},v={},w={};return this.each(function(){a(this).is("img")&&a(this).one("load",function(b){a(b.currentTarget).click(e)}).each(o)})}}(jQuery,this,this.document);